# 密码学基础

> 本文档整理自课程图片内容，结合《信息安全复习资料.md》

---

## 2.1 密码学的基本概念

◆ **密码是一种秘密书写的方法**。把明文变换为密文或密报，这种变换叫加密。而将密文变换为明文的过程称为脱密（解密）。

◆ **加密和脱密都要通过密钥(Key)的控制。**

```
          ┌─────┐
     ┌───→│ 加密 │────┐
     │    └─────┘    │
     │       ↑       ↓
  [明文]   [密钥]  [密文]
     ↑       ↓       │
     │    ┌─────┐   │
     └────│ 解密 │←──┘
          └─────┘

图 2-1 加密/脱密示意图
```

---

## 2.2 密码分析学

### 攻击传统密码体制的两种方法：

**1. 密码分析学**
- 依赖于算法的性质和明文的一般特征或某些明文密文对，这种形式的攻击利用算法的特征来推导出特别的明文或使用的密钥。

**2. 穷举攻击**
- 攻击者对一条密文尝试所有可能的密钥，直到把它转化为可读的有意义的明文。

---

## 2.3 频率攻击

### 英文中字母的相对频率

![频率攻击示意图]

**特点**：
- E字母出现频率最高（约12.75%）
- 其次是T（约9.25%）、A（约7.25%）
- 通过统计密文中字符出现频率可以破解简单替换密码
- **这是频率攻击的理论基础**

> 💡 **考试重点**：需要准确理解并能用自己的话解释什么是频率攻击（参考复习资料第95页）

**【参考内容】频率攻击（重点掌握）：**
- **定义**：通过分析密文中字符出现的频率来破解密码
- **原理**：如果加密不够好，明文的频率特征会反映在密文中
- **应用**：可以破解简单的替换密码
- **考试提示**：需要准确理解并能用自己的话解释什么是频率攻击

---

## 2.4 密码分析（攻击现代密码）

### 密码分析的主要攻击方式：

**唯密文攻击**：已知加密算法，要解密的密文。

**已知明文攻击**：已知加密算法，要解密的密文，用同一个密钥加密的一个或多个明密文对。

**选择明文攻击**：已知加密算法，要解密的密文，分析者任意选择的明文，及对应的密文。

**选择密文攻击**：已知加密算法，要解密的密文，分析者有目的的选择的一些密文，及对应的明文。（少）

**选择文本攻击**：已知加密算法，要解密的密文，分析者任意选择的明文，及对应的密文，分析者有目的的选择的一些密文，及对应的明文。（少）

> 💡 **考试重点**：理解各种攻击方式的区别（参考复习资料第85-88页）

**【参考内容】密码分析方法（攻击方法）：**
1. **唯密文攻击（Ciphertext-only Attack）**
   - 分析者只拥有密文，没有其他信息
   - 最难的攻击方式
   
2. **已知明文攻击（Known-plaintext Attack）**
   - 分析者拥有一些明文-密文对
   - 通过分析这些对来推断密钥
   
3. **选择明文攻击（Chosen-plaintext Attack）**
   - 分析者可以选择任意明文，获得对应的密文
   - 攻击能力较强
   
4. **选择密文攻击（Chosen-ciphertext Attack）**
   - 分析者可以选择任意密文，获得对应的明文
   - 攻击能力最强

---

## 2.5 对称密码系统

### 对称密码系统（一）

一个对称密码系统（Cryptosystem）CS，是一个五元集合CS={M, C, K, e, d}，其中，

- **明文消息空间**M={m}：表示明文消息的集合
- **密文消息空间**C={c}：表示密文消息的集合  
- **密钥空间**K={k}：表示密钥的集合
- **加密变换**e：表示一个确定的映射    e: K×M ⟶C
                                     (k,m) ↦ c
- **脱密变换**d：表示一个确定的映射    d: K×C ⟶M
                                     (k,c) ↦ m

### 对称密码系统（二）

满足下列条件：对于给定的密钥k，均有对给定的密钥k，由e和d诱导下列两个变换：

```
e_k : M ⟶ C
     m ↦ e(k,m)

d_k : C ⟶ M
     c ↦ e(k,c)
```

也称为加密/脱密变换。这时，定义IP所满足的条件可以记为，通常实用的密码系统在技术角度上还需要满足下列三个要求。

(1) 加密/脱密变换e、d对所有密钥k都有效防止计算中的阻断。
(2) 密码系统应易于实现。对任意给定的密钥k，有高效的加密/脱密计算方法。
(3) **密码系统的安全性仅依赖于密钥的保密，而不依赖于算法e和d的保密。**（重要原则）

---

## 2.6 经典加密算法

### Playfair加密法则

**明文做如下修改：**

1. ?被代替
2. ?对明文进行分组，每两个字母一组
3. ?如果某组中字母对相同，在中间插入一个**null letter**（比如q，x之类），再重新分组。
4. ?如果明文的字母数为奇数，在最后加上**null letter**。

**示例：**
- ?原明文：`Meet at the schoolhouse`
- ?新明文：`Me et at th es ch oq ol ho us eq`

根据明文组对m1m2在矩阵中的位置，采用**3种不同的加密法则**：

### Hill加密过程

设n=3，明文串p₁p₂p₃到密文串c₁c₂c₃的变换由下面方程组给出：

```
c₁ = (k₁₁p₁ + k₂₁p₂ + k₃₁p₃) mod 26

密钥    c₂ = (k₁₂p₁ + k₂₂p₂ + k₃₂p₃) mod 26

c₃ = (k₁₃p₁ + k₂₃p₂ + k₃₃p₃) mod 26
```

矩阵形式：

```
              ⎛k₁₁  k₁₂  k₁₃⎞
(c₁  c₂  c₃) = (p₁  p₂  p₃)·⎜k₂₁  k₂₂  k₂₃⎟ mod 26
              ⎝k₃₁  k₃₂  k₃₃⎠
```

---

## 2.7 分组密码的基本概念

**分组密码是一种加/解密算法，将输入的明文分组当作一个整体处理，输出一个等长的密文分组。**

特点：
- ?明文分组的长度，如64位或128位
- ?不足64或128位的尾组用适当的方式进行填充
- ?使用同一密钥和算法对每一组加密，输出固定长度的密文

```
M1    M2    M3        Mn
 ↓     ↓     ↓    ...  ↓
[E]   [E]   [E]       [E]
 ↓     ↓     ↓         ↓
C1    C2    C3        Cn
```

---

## 2.8 数据加密标准DES

### DES基本参数（必须掌握）⭐⭐⭐⭐⭐

- **分组密码**（64-bit 分组）
- **使用56-bit密钥**（从64-bit来产生）
- **16轮**
- **48-bit 子密钥**
- **Feistel结构**（除了初始和最终的置换）

> ⚠️ **重点考点**：DES的基本参数必须记住（参考复习资料第112-118页）

**【参考内容】DES（数据加密标准）基本参数（必须掌握）：**
- **分组长度**：**64位**
- **密钥长度**：**56位**（实际64位，8位用于奇偶校验）
- **轮数**：**16轮**
- **结构**：**Feistel结构**

**DES加密流程（重点）：**
1. **IP置换**（Initial Permutation）
2. **16轮Feistel变换**
3. **IP逆置换**（IP⁻¹）

> ⚠️ **重点考点**：IP置换和IP逆置换的使用必须掌握

### Feistel密码结构

**输入的分组被划分为相同长度的2块：L_{i-1} 和 R_{i-1}**

**在第i轮，**

```
L_i = R_{i-1}
R_i = L_{i-1} ⊕ F(K_i, R_{i-1})
```

**代换完成后做一次置换**

**多轮**

![Feistel结构示意图 - 包含多轮迭代的详细结构]

---

## 2.9 初始置换IP

◆ **IP是64bit的位置置换**，它表示把第58bit (t58)换到第1个bit位置，把第50bit(t50)换到第2个bit位置，......，把第7bit (t7)换到第64个bit位置。

### 表2.1 初始置换

```
                            IP
58  50  42  34  26  18  10   2  60  52  44  36  28  20  12   4
62  54  46  38  30  22  14   6  64  56  48  40  32  24  16   8
57  49  41  33  25  17   9   1  59  51  43  35  27  19  11   3
61  53  45  37  29  21  13   5  63  55  47  39  31  23  15   7
```

### IP置换表使用说明

**如何读取这个表：**

表中从左到右、从上到下依次是输出的第1、2、3、...、64位。
每个数字表示从原始输入的哪一位取值。

**具体含义：**
- 第1个数字是58 → 输出的第1位 = 输入的第58位
- 第2个数字是50 → 输出的第2位 = 输入的第50位
- 第3个数字是42 → 输出的第3位 = 输入的第42位
- ...
- 最后一个数字是7 → 输出的第64位 = 输入的第7位

**举例说明：**

假设输入的64位明文是：`b₁b₂b₃...b₅₈...b₆₄`

经过IP置换后：
- 输出的第1位 = b₅₈（原来的第58位）
- 输出的第2位 = b₅₀（原来的第50位）
- 输出的第3位 = b₄₂（原来的第42位）
- ...
- 输出的第64位 = b₇（原来的第7位）

> 💡 **记忆技巧**：这个表就是一个"搬家指南"，告诉每个位置应该从哪里搬过来

### IP逆置换

如果有简化的DES版本，其明文输入为8比特，初始置换表IP如下：

**IP: 2  6  3  1  4  8  5  7**

请给出其逆初始置换表。

**假设原文为：abcdefgh**
**经IP后M₁，变为：bfcadheg**

**逆初始置换与初始置换是互逆，即把M₁重新变为M**

**IP逆初始置换表：4  1  3  5  7  2  8  6**

---

## 2.10 S-盒（重点必考）⭐⭐⭐⭐⭐

### S盒的使用方法

**32=8*4bit输入 48=8*6bit输出 ...**

把48bit的数分成8组6bit的数，每组6bit插一个S-盒得到4bit的输出。S-盒变换示意图如图2-7所示。

```
            48=8×6bit 输入
    ┌──────────────────────────────┐
    │  │  │  │  │  │  │  │  │  │  │
    ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓
   ⭕ ⭕   ......  ⭕
  S-盒1 S-盒2      S-盒8
    │  │          │
    ↓  ↓          ↓
            32=8×4bit 输出
```

### 表2.2 8个S-盒的内容

[S₁ - S₈的详细数值表格]

### S盒使用说明（必考知识点）

**8个S-盒，每个把6位映射到4位**，S盒输入的**第一位和最后一位组成的2位二进制数**选择S盒4行代换值中的一行，**中间4位用来选择16列中的一列**。

**置换由子密钥和E表做异或后的结果来选取**，如在S1盒中，输入为011001，那么行为1(01)，列为12(1100)，值为9。**1001**

> ⚠️ **老师强调**："这道题我可以从现在考到退休都不变样"，输出必须是二进制形式（如1001），不能写十进制（如9）（参考复习资料第126-132页）

**【参考内容】S盒使用方法（必考）：**
- DES中有**8个S盒**
- 功能：将**6位输入**压缩为**4位输出**
- **使用方法**：
  - 例如输入为 011001
  - 行号：取第1位和第6位 → 01 = 1
  - 列号：取第2-5位 → 1100 = 12
  - 在S盒中查找第1行第12列的值，假设为9
  - **输出**：将9转换为**4位二进制** → **1001**
  
- **考试注意**：
  - 输出必须是**二进制形式**（如1001），不能写十进制（如9）
  - 这道题每年都考，"我可以从现在考到退休都不变样"
  - 需要提前理解和练习

---

## 2.11 DES雪崩效应 ⭐⭐⭐

### 雪崩效应定义

**一个好的加密算法，当密钥或明文任何变化时——无论大小——应该有几乎一半的密文位发生变化**

### Table 3.5 Avalanche Effect in DES

**例子：**

?**(a) 相同密钥，改变明文中一位**
?**(b) 相同明文，改变密钥中一位**
?**3或4轮后，几乎一半的密文位发生了变化**
?**16轮后，大量的"扰乱"出现了**

[详细的雪崩效应数据表 - 显示每一轮后改变的比特数]

> 💡 **考试重点**：需要理解雪崩效应的定义和意义（参考复习资料第136-140页）

**【参考内容】雪崩效应（重点）：**
- **定义**：明文或密钥中改变1位，密文中至少有50%的位发生变化
- **意义**：衡量分组密码质量的重要指标
- **要求**：几乎一半的密文位发生变化
- **作用**：
  - 保证密码算法的安全性
  - 防止通过微小变化推断出密钥或明文
  - 体现密码算法的混淆和扩散特性

---

## 2.12 公钥密码体制

### 公钥基本概念

**◆ 公钥密码体制**

公钥密码体制也称为**双密钥密码体制**或**非对称密码体制**，与此相对应，将序列密码和分组密码等称为单密钥密码体制或对称密钥密码体制。

非对称密钥管理系统则基于数学函数应用于数字处理的对象是数字。其使用两个独立的密钥。

表2.7总结了单钥加密和公开密钥加密的重要特征。

> 💡 **考试重点**：理解对称与非对称密码的区别（参考复习资料第141-150页）

**【参考内容】公钥密码与对称密码的区别（必须掌握）：**

**对称密码（传统密码）：**
- 加密和解密使用相同的密钥
- 密钥必须保密，不能公开
- 加密速度快，效率高
- 密钥分发困难（需要安全通道）
- 密钥数量多（n个人需要n(n-1)/2个密钥）

**非对称密码（公钥密码）：**
- 加密和解密使用不同的密钥（公钥和私钥）
- 公钥可以公开，私钥必须保密
- **公钥加密，私钥解密**（用于加密）
- **私钥签名，公钥验证**（用于签名）
- 解决了密钥分发问题
- 计算效率较低（比对称密码慢）
- 密钥数量少（n个人只需要2n个密钥）

---

## 2.13 RSA算法 ⭐⭐⭐⭐⭐（重中之重）

### RSA算法的目的

◆ **RSA算法研制的最初理念与目标是努力使互联网安全可靠，旨在解决DES算法秘密密钥利用公开信道传输分发的难题**。而实际结果不但很好地解决了这个难题，还可利用RSA来完成对电文的数字签名以抵抗对电文的否认与抵赖，同时还可以利用数字签名较容易地发现攻击者对电文的非法篡改，以保护数据信息的完整性。

◆ **RSA是第一个比较完善的公开密钥算法，它既能用于加密也能用于数字签名。在已公开的公钥算法中，RSA是最容易理解和实现的。**

### RSA算法简单描述

**RSA算法的实现步骤如下（这里设B为实现者）：**

a) B寻找出两个大素数p和q。                    why

b) B计算出n=p·q和 φ(n)=(p-1)(q-1)。

c) B选择一个随机数e (0<e<φ(n))，满足 (e, φ(n))=1 (即e和φ(n)互素)。**ed=1mod φ(n)**

d) B使用Euclidean（欧几里得）算法计算d= e⁻¹ (mod φ(n))。

e) B在目录中公开n和e作为他的公开密钥，保密p、q和d。

**攻击目标，d，要想得到d，e公开，只需知道φ(n)，如果想知道φ(n)，只需知道p,q，如何知道p,q，分解n**

### RSA算法加密解密过程

**密码分析者攻击RSA体制的关键点在于如何分解n。**若分解成功使n=pq，则可以算出：φ(n) = (p-1)(q-1)，然后由公开的e解出秘密的d。

加密时，对每一明文m计算密文：c=m^e (mod n)

解密时，对每一密文c计算明文：m=(m^e)^d (mod n) **（中国剩余定理）**
                                     why

**RSA算法主要用于数据加密和数字签名。RSA算法用于数字签名时，公钥和私钥的角色可变换，即将消息用d加密签名，用e验证签名。**

### RSA算法实例（安全参数）

**例2.1 假定用户B选择两个素数p=3, q=11,则n=pq=33，**
**φ(n)=(3-1)(11-1)=20。**

取e=3,显然 (e,φ(n)) = (3,20) =1,再由Euclidean算法，
对∀d∈ Z33={0,1,...,32},计算gcd(ed, 20),
若gcd (ed,20)= gcd(20, ed mod 20)= gcd(20,1) 则ed =
1(mod 20), 即d=e-1 (mod 20) ，在本例中求出d=7或d=27。

一般地,d的值不是唯一的,这里选d=7,即B公开n=33和e=3,保密p=3, q=11和d=7。现在用户A想把明文m=19发送给B。

### RSA算法实例结果

**A加密明文m=19，得密文：**

```
c=Ek(m)=m^e(mod  33)≡19^3(mod 33)=28
```

A在公开信道上将加密后的密文c=28发送给B,当B收到密文c=28时,解密可得：

```
C^d =287=19 (mod33)
```

从而B得到A发送的明文m=19。

若用以上算法对明文"SUZANNE"进行加密和解密，可得到如下表2.8的结果：

[详细的加密解密表格 - SUZANNE各字母的加密解密过程]

**模幂运算：[(a mod n)*(b mod n)]mod n=(a*b)mod n**

**88^7mod 187=[(88^4 mod 187)*(88^2 mod 187)*(88^1 mod 187)]mod 187**

**原理：在Zn中运用重复平方乘进行指数运算**

> ⚠️ **重点考点**：
> 1. RSA算法描述
> 2. 如何计算加密/解密
> 3. 为什么基于大整数因式分解
> 4. 正确性验证推导
> 5. 为什么不能抵抗选择明文攻击
> （参考复习资料第151-193页）

**【参考内容】RSA算法详解：**

**1. RSA基本原理：**
- 加密：C = M^e mod N
- 解密：M = C^d mod N
- 公钥：(e, N)
- 私钥：(d, N)

**2. 密钥生成步骤：**
1. 选择两个大素数 p 和 q
2. 计算 N = p × q
3. 计算 φ(N) = (p-1) × (q-1)
4. 选择公钥指数 e，满足 1 < e < φ(N) 且 gcd(e, φ(N)) = 1
5. 计算私钥指数 d，满足 d × e ≡ 1 (mod φ(N))

**3. RSA安全性基础（必考）：**
- **基于大整数因式分解难题**
- **为什么？**
  - 要破解私钥d，需要知道φ(N)
  - 要知道φ(N)，需要知道p和q
  - 要知道p和q，需要分解N
  - 因此RSA的安全性基于大整数因式分解

**4. RSA正确性验证（重点）：**
- 问题：为什么 M = C^d mod N = (M^e)^d mod N？
- 需要进行数学证明，课堂上已详细推导过
- 这是一道很有水平的题目

**5. RSA的攻击抵抗性（重点）：**
- ❌ **不能抵抗选择明文攻击**
- **原因**：
  - 给定两个消息M1和M2的密文C1和C2
  - 可以计算出C1×C2 = (M1×M2)^e mod N
  - 提交C1×C2作为选择密文，得到M1×M2
  - 从而可以推断出关于M1和M2的信息
- ⚠️ **老师强调**："每年都有答不对的，你说'能'抵抗，这一分就得不到了"

**6. RSA数字签名：**
- 签名过程：S = M^d mod N（用私钥）
- 验证过程：M = S^e mod N（用公钥）
- 已经学过RSA加密，签名就是反过来

**7. RSA相关考点总结：**
1. RSA算法描述
2. 如何计算加密/解密
3. 为什么基于大整数因式分解
4. 正确性验证推导
5. 为什么不能抵抗选择明文攻击

---

## 重点知识总结

### 必须掌握的内容：

1. **DES参数**：64位分组，56位密钥，16轮，Feistel结构
2. **S盒使用**：6位输入→4位输出，输出必须是二进制
3. **雪崩效应**：改变1位，约50%密文位变化
4. **RSA算法**：完整流程、安全性基础、计算实例
5. **密码分析方法**：唯密文、已知明文、选择明文、选择密文攻击
6. **频率攻击**：利用字符出现频率破解简单替换密码

### 与复习资料对应：

- 对应《信息安全复习资料.md》第三章：密码学基础
- 重要程度：⭐⭐⭐⭐⭐（考试重点章节）
- 必考内容：DES的S盒、RSA算法、雪崩效应

---

*本文档根据课程图片整理，建议结合《信息安全复习资料.md》深入学习RSA相关考点*

