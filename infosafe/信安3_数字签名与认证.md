# 数字签名与认证

> 本文档整理自课程图片内容，结合《信息安全复习资料.md》

---

## 3.1 RSA选择密文攻击 ⭐⭐⭐⭐⭐

### 为什么RSA不能抵抗选择密文攻击

**（选择密文意味着可以借用私钥）**

可以用随机数r把C掩盖为C'，
然后把C'用私钥解密得到M',
从M'乘以r⁻¹，即得M

**提示：m^e*r^e**

> ⚠️ **老师强调**："每年都有答不对的，你说'能'抵抗，这一分就得不到了"（参考复习资料第179-186页）

**【参考内容】RSA的攻击抵抗性：**

❌ **RSA不能抵抗选择明文攻击**
- **原因**：RSA具有同态性
  - 给定两个消息M1和M2的密文C1和C2
  - C1 = M1^e mod N，C2 = M2^e mod N
  - 可以计算出C1×C2 = (M1×M2)^e mod N
  - 提交C1×C2作为选择密文，得到M1×M2
  - 从而可以推断出关于M1和M2的信息
  
- ⚠️ **老师强调**："每年都有答不对的，你说'能'抵抗，这一分就得不到了"
- 这道题每年都有人答错，需要理解原因

---

## 3.2 One-way Hash function（哈希函数）⭐⭐⭐

### 如何理解抗弱抗强

**散列函数(单向+散列)**

**h = H(m)**，其中m任意，h定长

特性：
- ?有的散列函数并不满足单向(抗冲突)性质
- ?密码学上用的散列函数都是指单向散列函数

### 抗冲突性质

- ?给定h，找m满足H(m)=h很难
- ?给定m，找m'满足H(m')=H(m)很难（抗弱碰撞性）
- ?直接找m1和m2满足H(m1)=H(m2)很难（抗强碰撞性）
- ?例子：指纹，欠100还是1000000

### 举例

?**MD5、SHA1**

> 💡 **考试重点**：需要理解弱抗碰撞和强抗碰撞的区别（参考复习资料第217-237页）
>
> **核心思想**：攻击者越容易做到的事，算法越能让他做不到，说明算法越强

**【参考内容】哈希函数的抗碰撞性（重点）：**

**1. 单向性（基本要求）：**
- 给定散列值H(M)，难以找到消息M
- 这是哈希函数的基本安全要求

**2. 抗碰撞性（重点掌握）：**

**弱抗碰撞性（抗第二原像攻击）：**
- **定义**：给定消息M1，难以找到另一个消息M2使得H(M1) = H(M2)
- **攻击者的优势**：知道了M1，只需要找一个M2
- **安全要求**：即使知道M1，也找不到M2

**强抗碰撞性（抗碰撞攻击）：**
- **定义**：难以找到任意两个不同消息M1和M2使得H(M1) = H(M2)
- **攻击者的优势**：可以自由选择任意两个消息
- **安全要求**：任意两个消息都不能碰撞

**如何理解抗弱和抗强？**
- **核心思想**：攻击者越容易做到的事，算法越能让他做不到，说明算法越强
- 强抗碰撞比弱抗碰撞要求更高
- 强抗碰撞 → 弱抗碰撞（强的能推出弱的）
- 弱抗碰撞 ⇏ 强抗碰撞（弱的推不出强的）

**常见哈希算法：**
- SHA-1（已不够安全）
- SHA-256（目前安全）
- MD5（已被攻破，不安全）

> 📝 **考试提示**：理解这个概念，但答题时用书面语，不要用口语表达

---

## 3.3 数字证书 ⭐⭐⭐

### 数字证书的概念：

◆ **在PKI密钥管理服务中公钥的载体是数字证书，CA就是通过生成、发布、撤销数字证书来提供密钥管理服务。**

数字证书是各实体（持卡人/个人、商户/企业、网关/银行等）在网上信息交流及商务交易活动中的身份证明，是一个经CA数字签名的包含实体身份信息（如实体的名称、电子邮件等）、实体公钥信息的文件。

◆ **PKI发展至今存在多种数字证书模型，而且每种证书都具有各自不同的格式，目前最为通用的证书标准是X.509。**

◆ **X.509证书由用户公共密钥和用户标识符组成。此外还包括版本号、证书序列号、CA标识符、签名算法标识、签发者名称、证书有效期等信息。**

> 💡 **考点**：数字证书的本质就是数字签名，与震网病毒的联系（参考复习资料第274-295页）

**【参考内容】数字证书与PKI：**

**数字证书的本质：**
- **本质就是数字签名**
- 用于身份识别和公钥认证
- 由可信的第三方（CA）签发

**为什么需要数字证书？**
- 防止公钥假冒（解决"中间人攻击"）
- 解决公钥分发问题
- 建立信任体系

**PKI体系：**
- **CA（证书颁发机构）**：签发和管理证书
- **RA（注册机构）**：验证用户身份
- **证书库**：存储和分发证书
- **证书撤销列表（CRL）**：废除的证书清单

**与震网病毒的联系：**
- 震网病毒突破了某半导体公司的数字证书
- 获取了合法的数字签名
- 这是实施病毒攻击的必要一步
- 使病毒看起来像是合法软件
- **考试重点**：看到"数字证书"要能联想到震网病毒

**震网病毒（Stuxnet）关键技术点：**
1. **四个零日漏洞（0-day）**
2. **数字证书突破**（突破了半导体公司的证书）
3. **完整的攻击链**（针对工业控制系统）

> 📝 **答题要求**：不能简单从书上抄几句话，要结合视频内容深入理解，说出深层次的东西

---

## 3.4 消息鉴别码与数字签名的区别 ⭐⭐⭐

### 关键区别

| 特性 | 数字签名 | 消息鉴别码 |
|------|----------|-----------|
| 技术基础 | 公钥密码 | 对称密码 |
| 不可抵赖性 | ✅ 支持 | ❌ 不支持 |
| 公开验证 | ✅ 可以 | ❌ 不可以 |
| 第三方验证 | ✅ 可以 | ❌ 不可以 |
| 应用场景 | 需要法律效力 | 内部系统 |

> 💡 **考试重点**：需要能够区分数字签名和消息鉴别码（参考复习资料第246-273页）

**【参考内容】消息鉴别码与数字签名的区别（重点）：**

| 特性 | 数字签名 | 消息鉴别码（MAC） |
|------|----------|-----------|
| **技术基础** | 公钥密码（非对称） | 对称密码 |
| **密钥** | 公钥+私钥（两个密钥） | 共享密钥（一个密钥） |
| **不可抵赖性** | ✅ 支持 | ❌ 不支持 |
| **公开验证** | ✅ 可以（任何人用公钥验证） | ❌ 不可以（需要共享密钥） |
| **第三方验证** | ✅ 可以 | ❌ 不可以 |
| **应用场景** | 需要法律效力、公开验证 | 内部系统、双方通信 |
| **计算效率** | 较慢 | 较快 |
| **安全性依赖** | 数学难题（如大整数因式分解） | 密钥保密 |

**为什么MAC不支持不可抵赖性？**
- 发送方和接收方共享同一个密钥
- 接收方也可以生成相同的MAC
- 无法证明MAC是由发送方生成的
- 第三方无法仲裁

**为什么数字签名支持不可抵赖性？**
- 只有持有私钥的人才能生成签名
- 任何人都可以用公钥验证签名
- 可以向第三方证明签名的来源

**应用示例：**
- **数字签名**：合同签署、电子政务、证书颁发
- **消息鉴别码**：银行内部系统、VPN通信、文件完整性校验

> ⚠️ **重点**：课本可能没有详细说明这些区别，需要自己理解

---

## 重点知识总结

### 必须掌握的内容：

1. **RSA不能抵抗选择密文攻击**及其原因
2. **哈希函数的抗碰撞性质**：弱抗碰撞vs强抗碰撞
3. **数字证书的本质**：就是数字签名
4. **数字签名vs消息鉴别码**：不可抵赖性是关键区别
5. **数字签名的功能**：身份验证、数据完整性、不可抵赖性、防篡改等

### 与复习资料对应：

- 对应《信息安全复习资料.md》第四章：数字签名与认证
- 重要程度：⭐⭐⭐⭐
- 必考内容：RSA攻击抵抗性、哈希函数特性、数字证书

---

*本文档根据课程图片整理，建议结合《信息安全复习资料.md》深入学习*


