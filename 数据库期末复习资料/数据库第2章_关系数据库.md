# 数据库第2章 - 关系数据库

> 整理自数据库期末复习PPT

---

## 2.1 第二章 关系数据库.pptx


### 幻灯片 1

数据库原理


### 幻灯片 2

第二章 关系数据库
关系理论建立在集合代数理论基础上，用数学方法来处理数据库中的数据。
E.F.Codd于二十世纪70年代初提出关系数据理论，他因此获得1981年的ACM图灵奖。
1970年，E.F.Codd在美国计算机学会会刊“Communications of the ACM”上发表论文“A Relational Model of Data for Shared Banks”,ACM1983年把该论文列为从1958年以来的四分之一世纪中具有里程碑意义的25篇研究论文之一。
早期代表系统
SystemＲ：由IBM研制。
INGRES：由加州Berkeley分校研制。
90年代，关系模型数据库系统已成为商用主流数据库系统，广泛应用于各个领域。
目前主流的商业数据库系统:Oracle，MySql，MS SQL Server，IBM DB2等。


### 幻灯片 3

第二章    关系数据库

	2.1 关系数据模型
	2.2 关系的完整性
	2.3 关系代数


### 幻灯片 4

2.1 关系数据模型
关系数据模型由关系数据结构、关系操作集合和关系完整性约束三部分组成。
1 关系数据结构：二维表
(1) 域(Domain):一组具有相同数据类型的值的集合。
整数
 实数
 介于某个取值范围的整数
 长度指定长度的字符串集合
 {‘男’，‘女’}
 ……………..
2.1.1 关系数据模型概述


### 幻灯片 5

2.1 关系数据模型
2.1.1 关系数据模型概述
若Di（i=1,2,…,n）为有限集，基数（元组个数）为mi个,则其笛卡儿积的基数为：
(2)笛卡儿积(Cartesian Product)
    给定一组域D1，D2，…,Dn，则其笛卡儿积为：
 D1D2…Dn={(d1, d2,…, dn)∣ di∈Di,i=1,2,…,n}
其中：每一元素(d1, d2,…, dn)为一个n元组（元组）;
      元素中的每一个值di为一个分量。


### 幻灯片 6

2.1 关系数据模型
2.1.1 关系数据模型概述
『例』有2个域
       姓名: D1={张金,王银,李玉}，
       年龄: D2={20,21,22}
则笛卡尔积   
    D1D2 =
      {(张金,20), (张金,21), (张金,22), 
        (王银,20), (王银,21), (王银,22),
        (李玉,20), (李玉,21), (李玉,22)
      }


### 幻灯片 7

2.1 关系数据模型
2.1.1 关系数据模型概述
(3) 关系(Relation)
          － D1D2…Dn的子集叫做在域D1，D2，…,Dn上的关系，记：R（D1，D2，…,Dn）
若n=1：称为单元关系（Unary relation）
若n=2:  称为二元关系（Binary relation）

**表格内容：**

D1 | D2
张金 | 20
王银 | 21
李玉 | 22


### 幻灯片 8

2.1 关系数据模型
2.1.1 关系数据模型概述
2 关系操作：集合操作方式（一次一集合）


### 幻灯片 9

2.1 关系数据模型
2.1.1 关系数据模型概述
3.关系完整性约束：

         实体完整性
         参照完整性
         用户定义的完整性


### 幻灯片 10

2.1 关系数据模型
2.1.2 基本术语
（1）关系（Relation）：关系就是二维表,二维表名就是关系名。
（2）属性（Attribute）：二维表中的列称为属性（字段）；每个属性有一个名称，称为属性名；二维表中对应某一列的值称为属性值。
（3）值域（Domain）：二维表中属性的取值范围称为值域，每一个属性都有一个取值范围，每一个属性对应一个值域，不同的属性可对应于同一值域。
（4）元组（Tuple）：二维表中的行称为元组（记录值）。 
（5）分量（Component）：元组中的每一个属性值称为元组的一个分量，n元关系的每个元组有n个分量。


### 幻灯片 11

11

**表格内容：**

学号 | 姓名 | 性别 | 所在系
002210 | 王雪莲 | 女 | 软件工程
005130 | 白亚春 | 男 | 软件工程
005220 | 陈韬 | 男 | 计算机系
005221 | 袁更旭 | 男 | 计算机系
2.1 关系数据模型
2.1.1 关系数据模型概述
学生表
关系名
关系


### 幻灯片 12

2.1 关系数据模型
2.1.2 基本术语
(6) 候选码：能唯一标识一个元组的某一属性组。
(7) 主码：候选码中的某一个。
(8) 主属性：包含在任一候选码的属性，例如教师表中的工号和身份证号。
(9) 非主属性：不包含在任一候选码中的属性，例如教师表中的姓名、性别等。
(10) 全码：该关系模式中所有属性组均为候选码。
如：学生（学号，姓名，性别，所在系）
       教师（工号，姓名，性别，出生年月，身份证号，职称，所在系）

**表格内容：**

课程号 | 工号
C201 | 0022102
C505 | 0051309
C505 | 0052201
C506 | 0052201
{c201,0022102}
{c505,0051309}
{c505,0052201}
{C506,0052201}
候选码：
（课程号，工号）


### 幻灯片 13

2.1 关系数据模型
2.1.2 基本术语
(11)外码（Foreign key）
    设F是基本关系R的一个或一组属性，不是R的主码，但F是基本关系S的主码，则称F是R的外码。
R：为参照关系；
S：为被参照关系或目标关系。

「例」学生（学号，姓名，性别，出生年月，家庭地址，系号）
      系（系号，系名）


### 幻灯片 14

2.1 关系数据模型
2.1.2 基本术语

**表格内容：**

学号 | 姓名 | 性别 | 家庭地址 | 系号
002210 | 王雪莲 | 女 | ………. | d01
005130 | 白亚春 | 男 | …….. | d02
005220 | 陈韬 | 男 | …….. | d02
005221 | 袁更旭 | 男 | ……… | NULL

**表格内容：**

系号 | 系名
d01 | 软件工程系
d02 | 计算机系
d03 | 信息安全系
主码
外码
系
学生


### 幻灯片 15

2.1 关系数据模型
2.1.2 基本术语

**表格内容：**

学号 | 姓名 | 性别 | 所在系 | 班长号
002210 | 王雪莲 | 女 | 软件工程 | 002210
005130 | 白亚春 | 男 | 软件工程 | 002210
005220 | 陈韬 | 男 | 计算机系 | 005221
005221 | 袁更旭 | 男 | 计算机系 | 005221
注：不仅两个或两个以上关系间可以存在主码和外码的关系，同一关系内部属性间也可存在主码和外码的关系。


### 幻灯片 16

系DEPT（系号，系名，负责人）

   学生S（学号，姓名，性别，系号，出生年月）
       
   课程C（课程号，课程名，学分）
   
   选课SC（学号，课程号，成绩）
『例』学生选课关系模型
2.1 关系数据模型
2.1.2 基本术语


### 幻灯片 17

2.1 关系数据模型
2.1.2 基本术语
（12）关系模式（Relation Schema）：二维表的结构称为关系模式，相当于文件结构或记录结构。设关系名为REL，其属性为A1，A2，…，An，则关系模式可以表示为：      REL（A1，A2，…，An）
     对每个Ai（i=1，…，n）还包括该属性到值域的映象，即属性的取值范围。
例如：关系模式：学生（学号，姓名，性别，所在系） 
                                   教师（工号，姓名，性别，出生年月，身份证号，职称，所在系）
（13）关系模型（Relation Model）：关系模型是所有的关系模式、属性名和码的汇集，是模式描述的对象。
（14）关系数据库（Relation Database）：对应于一个关系模型的所有关系的集合。
“学生选课”关系模型包含如下关系模式以及这些模式之间的相互关系：
学生（学号，姓名，性别，所在系）
系（系号，系名，系主任）
课程（课号，课名，学分）
选课（学号，课号，成绩）


### 幻灯片 18

2.1 关系数据模型
2.1.3 关系的性质
1.关系中的元组分量具有原子性，即每一个分量都必须是不可分的数据项。

**表格内容：**

学号 | 姓名 | 性别 | 联系方式 | 
 |  |  | 手机 | 固定电话
0022102 | 王雪莲 | 女 | 15812345678 | 68021234
 |  |  |  | 
不具有原子性


### 幻灯片 19

2.1 关系数据模型
2.1.3 关系的性质
2.列是同质的。 
3.关系中行的顺序、列的顺序可以任意互换，不会改变关系的意义。即行、列无序
不同质

**表格内容：**

学号 | 姓名 | 性别 | 所在系 | 班长号
002210 | 王雪莲 | 女 | 软件工程 | 002210
005130 | 白亚春 | 软件工程 | 男 | 005221
005220 | 陈韬 | 男 | 005221 | 计算机系
005221 | 袁更旭 | 男 | 计算机系 | 005221


### 幻灯片 20

2.1 关系数据模型
2.1.3 关系的性质
4.关系中的任意两个元组不能相同。


### 幻灯片 21

2.1 关系数据模型
2.1.3 关系的性质
５.不同的列可出自同一个域
例如:
员工(雇员工号、雇员姓名、出生日期、性别、家庭住址、工资、经理工号、部门号）


注意：同一关系中，不同的属性要给予不同的属性名。
值域相同


### 幻灯片 22

小结
关系数据模型；
关系中若干术语
关系的性质
谢谢观看！

---

## 2.2 第二章 关系数据库.pptx


### 幻灯片 1

数据库原理


### 幻灯片 2

第二章    关系数据库

	2.1 关系数据模型
	2.2 关系的完整性
	2.3 关系代数


### 幻灯片 3

2.2 关系的完整性
一. 实体完整性（Entity Integrity）
规则：若属性A是基本关系R的主属性，则属性A不能取空值。
注意：
（1）该规则针对基本关系；
（2）基本关系中所有主属性都不能取空值；
（3）空值即为“不知道”或“无意义”的值。
意义：关系对应现实世界中的实体集，元组对应实体，实体是相互可区分的，通过主码来唯一标识，若主码为空，则出现不可标识的实体，这是不容许的。


### 幻灯片 4

2.2 关系的完整性
一. 实体完整性（Entity Integrity）。

**表格内容：**

学号 | 课号 | 成绩
002210 | C01 | 80
002210 | C02 | 90
005130 | C01 | 90
005130 | C02 | 60
005130 | C03 | 
005220 | C01 | 85
005221 | C01 | 40
『例』选课（学号，课程号，成绩）
可以为空
不能为空
不能为空

**表格内容：**

学号 | 姓名 | 性别 | 所在系
002210 | 王雪莲 | 女 | 软件工程
005130 | 白亚春 | 男 | 
005220 | 陈韬 | 男 | 计算机系
005221 | 袁更旭 | 男 | 计算机系
『例』学生（学号，姓名，性别，所在系）
不能为空
可以为空


### 幻灯片 5

2.2 关系的完整性
规则：若属性F 是基本关系R 的外码，它与基本关系S 的主码Ks相对应，则对于R 中每个元组在F上的取值必须为：
   （1）或取空值（F 的每个属性均为空）；
   （2）或等于S 中某个元组的主码值。
二.参照完整性（Referential Integrity）


### 幻灯片 6

2.2 关系的完整性
『例』下例中，关系S在系号上的取值有两种可能：
系号是关系模式系的主码，也是关系模式学生的外码。
在学生关系中，系号的取值只允许有两种可能：
为空值
等于系关系中某个主码值，不能出现一个不存在的系号

**表格内容：**

学号 | 姓名 | 性别 | 系号
002210 | 王雪莲 | 女 | D01
005130 | 白亚春 | 男 | NULL
005220 | 陈韬 | 男 | D02
005221 |  | 男 | D02

**表格内容：**

系号 | 系名
D01 | 软件工程
D02 | 计算机
D03 | 信息安全
系
学生


### 幻灯片 7

2.2 关系的完整性
✾不仅两个或两个以上的关系间可以存在参照引用关系，同一关系内部属性间也可能存在参照引用关系。

**表格内容：**

学号 | 姓名 | 性别 | 所在系 | 班长号
002210 | 王雪莲 | 女 | 软件工程 | 002210
005130 | 白亚春 | 男 | NULL | NULL
005220 | 陈韬 | 男 | 计算机系 | 005221
005221 | 袁更旭 | 男 | 计算机系 | 005221
主码
外码


### 幻灯片 8

2.2 关系的完整性
✾外码与相应的主码名可以取不同的名字，但是必须定义在同一个（或一组）域上。

**表格内容：**

学号 | 姓名 | 性别 | 所在系
002210 | 王雪莲 | 女 | D01
005130 | 白亚春 | 男 | NULL
005220 | 陈韬 | 男 | D02
005221 | 袁更旭 | 男 | D02

**表格内容：**

系号 | 系名
D01 | 软件工程
D02 | 计算机
D03 | 信息安全
系
学生


### 幻灯片 9

2.2 关系的完整性
三.用户定义的完整性（User-defined Integrity）
     针对某个具体数据库的约束条件，由应用环境决定，它反映某一具体应用所涉及的数据必须满足的语义要求。
如:
成绩在0-100之间
学号、课号的编号规则
性别只能取‘男’或‘女’

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
002210 | 02 | 90
005221 | 01 | 65

**表格内容：**

课程号 | 课程名 | 学分
01 | C++ | 6
02 | 数据库原理 | 4
03 | 操作系统 | 4
04 | 离散数学 | 3

**表格内容：**

学号 | 姓名 | 性别 | 所在系
002210 | 王雪莲 | 女 | D01
005130 | 白亚春 | 男 | NULL
005220 | 陈韬 | 男 | D02
005221 | 袁更旭 | 男 | D02
学生选课
学生
课程


### 幻灯片 10

2.2 关系的完整性
四.完整性约束的作用
    数据完整性的作用就是要保证数据库中的数据是正确的，提高了数据库的正确度。
 (1)执行插入操作时检查完整性
 (2)执行删除操作时检查完整性
 (3)执行更新操作时检查完整性


### 幻灯片 11

小结
三类完整性约束
实体完整性
参照完整性
用户自定义的完整性
谢谢观看！

---

## 2.3.1第二章 关系数据库.pptx


### 幻灯片 1

数据库原理


### 幻灯片 2

第二章    关系数据库

	2.1 关系数据模型
	2.2 关系的完整性
	2.3 关系代数


### 幻灯片 3

2.3 关系代数
关系代数作为研究关系数据语言的数学工具，是一种抽象的查询语言，用对关系的运算来表达查询。
运算三要素：运算对象，运算符，运算结果
运算对象：关系
运算结果：关系


### 幻灯片 4

2.3 关系代数
传统的集合运算是二目运算，包括并、交、差、广义笛卡尔积四种运算，如图。
2.3.1 传统的集合运算


### 幻灯片 5

2.3 关系代数
2.3.1 传统的集合运算
1. 并（Union）
— 所有至少出现在两个关系中之一的元组的集合。
注：两个关系R和S若进行并运算，则它们必须是相容的：
  （1）关系R和S必须是同目的，即它们的属性数目必须相同；
  （2）对i，R的第i个属性的域必须和S的第i个属性的域相同。
RS ={ t | tR  tS }


### 幻灯片 6

2.3 关系代数
2.3.1 传统的集合运算
『例』


### 幻灯片 7

2.3 关系代数
2.3.1 传统的集合运算
『实例A』:某学生成绩管理系统使用的数据表部分数据如下:

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
005221 | 01 | 65
G1

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005130 | 02 | 90
G2
G1UG2

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
005221 | 01 | 65
005130 | 02 | 90


### 幻灯片 8

2.3 关系代数
2.3.1 传统的集合运算
2. 差（Difference）
    —由属于R但是不属于S的元组构成的集合。
R－S={t|t∈R∧t∈S}
注：R和S必须相容（属性集相同，但属性名可不同）


### 幻灯片 9

2.3 关系代数
2.3.1 传统的集合运算
『例』


### 幻灯片 10

2.3 关系代数
2.3.1 传统的集合运算
『实例B』

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
005221 | 01 | 65
G1

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005130 | 02 | 90
G2
G2-G1

**表格内容：**

学号 | 课程号 | 成绩
005130 | 02 | 90
G1-G2

**表格内容：**

学号 | 课程号 | 成绩
005220 | 02 | 70
005221 | 01 | 65


### 幻灯片 11

2.3 关系代数
2.3.1 传统的集合运算
3. 交（Intersection）
    —所有同时出现在两个关系中的元组集合。
RS ={ t | tR  tS }
注：
 交运算可以通过差运算来表示：
RS = R  (R  S)
 R和S必须相容（属性集相同、次序相同，但属性名可不同）


### 幻灯片 12

2.3 关系代数
2.3.1 传统的集合运算
『例』


### 幻灯片 13

2.3 关系代数
2.3.1 传统的集合运算
『实例C』

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
005221 | 01 | 65
G1

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005130 | 02 | 90
G2
G1∩G2

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80


### 幻灯片 14

2.3 关系代数
2.3.1 传统的集合运算
4. 广义笛卡儿积（Extended Cartesian Product）
    －是两个关系的元组集合所组成的新关系。
   RS={     |trR  tsS }
注： 
（1）两个关系R，S，其目数分别为r、s，则它们的笛卡尔积是所有这样的元组集合：元组的前r个分量是R中的一个元组，后s个分量是S中的一个元组, RS的目数为(r+s)。
（2）若R有m个元组，S有n个元组，则R×S有m×n个 元组。


### 幻灯片 15

2.3 关系代数
2.3.1 传统的集合运算
『例』


### 幻灯片 16

2.3 关系代数
2.3.1 传统的集合运算
『实例D』

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
005221 | 01 | 65
G

**表格内容：**

学号 | 姓名
002210 | 王雪莲
050220 | 陈韬
005221 | 袁更旭
Ｓ

**表格内容：**

S.学号 | 姓名 | G.学号 | 课程号 | 成绩
002210 | 王雪莲 | 002210 | 01 | 80
002210 | 王雪莲 | 005220 | 02 | 70
002210 | 王雪莲 | 005221 | 01 | 65
050220 | 陈韬 | 002210 | 01 | 80
050220 | 陈韬 | 005220 | 02 | 70
050220 | 陈韬 | 005221 | 01 | 65
005221 | 袁更旭 | 002210 | 01 | 80
005221 | 袁更旭 | 005220 | 02 | 70
005221 | 袁更旭 | 005221 | 01 | 65
S×G
思考：数据合理吗？


### 幻灯片 17

2.3 关系代数
2.3.2 专门的关系运算
选择（Selection）－限制
   －从关系R中选择符合条件的元组构成新的关系。
σF(R) = {t|t∈R ∧ F(t)=‘真’}
注：
（1）选择条件F：是一个逻辑表达式，基本形式为：XθY
（２）σF(R) ，表示从R中选择满足条件(使逻辑表达式F为真)的元组；
（３）从行的角度进行计算。


### 幻灯片 18

2.3 关系代数
2.3.2 专门的关系运算
或写作：σ4<20 (Student)
『例』  σSage<20(Student)

**表格内容：**

Sno | Sname | Ssex | Sage | sdept
002210
005221
005130 | 王雪莲
袁更旭
白亚春 | 女
男
男 | 20
19
18 | 软件工程
计算机系
软件工程


### 幻灯片 19

2.3 关系代数
2.3.2 专门的关系运算
『例』 σSsex = ‘男’  Sdept = ‘计算机系’(Student)
或写作：σ3 = ‘男’  5= ‘计算机系’(Student)

**表格内容：**

Sno | Sname | Ssex | Sage | sdept
002210
005221
005130 | 王雪莲
袁更旭
白亚春 | 女男
男 | 20
19
18 | 软件工程
计算机系
软件工程


### 幻灯片 20

2.3 关系代数
2.3.2 专门的关系运算
2.  投影（Projection）
     －从关系R中选择若干属性列组成新的关系。
πA(R) = {t[A]|t∈R}
注：
（1） πA1,A2,…,An(R),表示从R中选择属性集A1,A2,…, An组成新的关系;
（2）从列的角度进行计算；对一个关系R进行垂直分割，消去某些列，并重新安排列的顺序。


### 幻灯片 21

2.3 关系代数
2.3.2 专门的关系运算
『例 』 πSname,Sage(Student)
或写作：π2,4(Student)

**表格内容：**

Sno | Sname | Ssex | Sage | sdept
002210
005221
005130 | 王雪莲
袁更旭
白亚春 | 女男
男 | 20
19
18 | 软件工程
计算机系
软件工程

**表格内容：**

Sname | Sage
王雪莲
袁更旭
白亚春 | 20
19
18


### 幻灯片 22

2.3 关系代数
2.3.2 专门的关系运算
『例』 πSdept(student)

**表格内容：**

Sdept
软件工程
计算机系
注：投影运算的结果中,可能会取消某些元组，因为需要删除重复元组。

**表格内容：**

Sno | Sname | Ssex | Sage | sdept
002210
005221
005130 | 王雪莲
袁更旭
白亚春 | 男
男
女 | 20
19
18 | 软件工程
计算机系
软件工程


### 幻灯片 23

2.3 关系代数
2.3.2 专门的关系运算
2.  连接（Join）－θ连接
     －从R×S的笛卡儿积中，选取属性满足某一条件的元组。
注：
（1）A和B分别为R和S上度数相等且可比的属性组；
（2）θ为比较运算符。
（3）连接运算从RS中选出tr[A]和ts[B]满足θ运算的元组。


### 幻灯片 24

2.3 关系代数
2.3.2 专门的关系运算


### 幻灯片 25

2.3 关系代数
2.3.2 专门的关系运算
等值连接： θ为“＝”的连接运算
即：从RS中选出A、B属性组相等的那些元组


### 幻灯片 26

2.3 关系代数
2.3.2 专门的关系运算
『例』


### 幻灯片 27

2.3 关系代数
2.3.2 专门的关系运算
自然连接： 特殊的等值连接
即：要求两个关系中进行比较的分量必须是相同的属性组，并且在结果中删除重复的属性列。
注：从行和列的角度进行计算
①计算R×S ；
②挑选R和S中满足R.A1=S.A1，…，R.Ak=S.Ak的那些元组；
③去掉S.A1，…，S.A k这些列。


### 幻灯片 28

2.3 关系代数
2.3.2 专门的关系运算
『例』


### 幻灯片 29

2.3 关系代数
2.3.2 专门的关系运算
『实例E』

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
002210 | 02 | 90
005221 | 01 | 65
G

**表格内容：**

学号 | 姓名
002210 | 王雪莲
005221 | 袁更旭
005130 | 白亚春
Ｓ

**表格内容：**

S.学号 | 姓名 | G.学号 | 课程号 | 成绩
002210 | 王雪莲 | 002210 | 01 | 80
002210 | 王雪莲 | 002210 | 02 | 90
005221 | 袁更旭 | 005221 | 01 | 65

**表格内容：**

S.学号 | 姓名 | 课程号 | 成绩
002210 | 王雪莲 | 01 | 80
002210 | 王雪莲 | 02 | 90
005221 | 袁更旭 | 01 | 65


### 幻灯片 30

2.3 关系代数
2.3.2 专门的关系运算
外连接
  在通常的连接中,只有满足连接条件的元组才能构成新的关系。外连接根据连接时保留表中记录的侧重不同分为：左外连接、右外连接、全外连接。
A、左外连接
   将左表中的所有记录分别与右表中的每条记录进行组合，结果集中除返回连接的记录以外，还在查询结果中返回左表中不符合条件的记录，并在右表的相应列中填上空值，有些不允许为空的属性值则填0值等。


### 幻灯片 31

2.3 关系代数
2.3.2 专门的关系运算
『实例E』列出每个学生的基本情况及其选课情况。

**表格内容：**

S.学号 | 姓名 | 课程号 | 成绩
002210 | 王雪莲 | 01 | 80
002210 | 王雪莲 | 02 | 70
005221 | 袁更旭 | 01 | 65
005130 | 白亚春 | NULL | NULL

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
002210 | 02 | 90
005221 | 01 | 65

**表格内容：**

学号 | 姓名
002210 | 王雪莲
005221 | 袁更旭
005130 | 白亚春
G
S

**表格内容：**

S.学号 | 姓名 | 课程号 | 成绩
002210 | 王雪莲 | 01 | 80
002210 | 王雪莲 | 02 | 90
005221 | 袁更旭 | 01 | 65
左外连接
自然连接


### 幻灯片 32

2.3 关系代数
2.3.2 专门的关系运算
B、右外连接
      将左表中的所有记录分别与右表中的每条记录进行组合，结果集中除返回连接的记录以外，还在查询结果中返回右表中不符合条件的记录，并在左表的相应列中填上空值，有些不允许为空的属性值则填0值等。


### 幻灯片 33

2.3 关系代数
2.3.2 专门的关系运算
『实例F』列出所有课程，并给出选修该课程的学生学号。      
Π学号,课程号(G)   C

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
002210 | 02 | 90
005221 | 01 | 65

**表格内容：**

课程号 | 课程名 | 学分
01 | C++ | 6
02 | 数据库原理 | 4
03 | 操作系统 | 4
04 | 离散数学 | 3

**表格内容：**

学号 | 课程号 | 课程名 | 学分
002210 | 01 | C++ | 6
005220 | 02 | 数据库原理 | 4
002210 | 02 | 数据库原理 | 4
005221 | 01 | C++ | 6
NULL | 03 | 操作系统 | 4
NULL | 04 | 离散数学 | 3
G                                                      C


### 幻灯片 34

2.3 关系代数
2.3.2 专门的关系运算
C、全外连接
      将左表中的所有记录分别与右表中的每条记录进行组合，结果集中除返回连接的记录以外，还在查询结果中返回两表中不符合条件的记录，并在左表或右表的相应列中填上空值，有些不允许为空的属性值则填0值等。


### 幻灯片 35

2.3 关系代数
2.3.2 专门的关系运算
『实例G』某公司允许销售员和非销售员都可以销售商品，希望列出所有销售人员名单和所有的销售情况。

**表格内容：**

工号 | 姓名
1 | 李求一
2 | 王巧敏
3 | 张零七
4 | 钱守空
5 | 周运
销售人员名单（XSMD）

**表格内容：**

工号 | 销售额
1 | 50000
2 | 150000
3 | 350000
6 | 650000
7 | 850000
销售业绩(XSYJ)


### 幻灯片 36

2.3 关系代数
2.3.2 专门的关系运算
XSMD      XSYJ

**表格内容：**

销售名单.工号 | 姓名 | 销售业绩.工号 | 销售额
1 | 李求一 | 1 | 50000
2 | 王巧敏 | 2 | 150000
3 | 张零七 | 3 | 350000
4 | 钱守空 | NULL | NULL
5 | 周运 | NULL | NULL
6 | NULL | 6 | 650000
7 | NULL | 7 | 600000
XSMD.工号=XSYJ.工号


### 幻灯片 37

2.3 关系代数
2.3.2 专门的关系运算
自连接就是同一个表的两个副本之间的连接。实际应用中，给两个表分别指定不同的别名。
自连接：
选课(SC)
『例』
思考：如何获得至少选修了2门课程的同学学号？

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
002210 | 02 | 90
005221 | 01 | 65


### 幻灯片 38

2.3 关系代数
2.3.2 专门的关系运算

**表格内容：**

学号 | 课程号 | 成绩 | 学号 | 课程号 | 成绩
002210 | 01 | 80 | 002210 | 02 | 90
002210 | 02 | 90 | 002210 | 01 | 80

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
002210 | 02 | 90
005221 | 01 | 65

**表格内容：**

学号 | 课程号 | 成绩
002210 | 01 | 80
005220 | 02 | 70
002210 | 02 | 90
005221 | 01 | 65


### 幻灯片 39

2.3 关系代数
2.3.2 专门的关系运算
4.  除法（Division）
      关系R(X,Y)和S(Y,Z) ，其中X,Y,Z为属性组。R中的Y与S中的Y必须出自同一域。则R ÷S得到一个新的关系P(X)，P是R中满足下列条件的元组在X属性列上的投影：元组在X上的分量值x的象集Yx包含S在Y上的投影的集合。
R ÷ S = {tr[X]|tr∈R πy(S)⊆Yx}


### 幻灯片 40

2.3 关系代数
2.3.2 专门的关系运算

**表格内容：**

A | B | C
a1 | b1 | c2
a2 | b3 | c7
a3 | b4 | c6
a1 | b2 | c3
a4 | b6 | c6
a2 | b2 | c3
a1 | b2 | c1

**表格内容：**

B | C | D
b1 | c2 | d1
b2 | c1 | d1
b2 | c3 | d2
R
S
a1:{(b1,c2),(b2,c3),(b2,c1)}
a2:{(b3,c7),(b2,c3)}
a3:{(b4,c6)}
a4:{(b6,c6)}
πB,C(S) :{(b1,c2),(b2,c3),(b2,c1)}
『例』


### 幻灯片 41

2.3 关系代数
2.3.2 专门的关系运算

**表格内容：**

Sno | Cno
1001 | C1
1001 | C2
1001 | C3
1002 | C1
1002 | C3
1003 | C1
1004 | C2

**表格内容：**

Cno | Cname
C1 | 数据库
C2 | 高数
C3 | C语言
SC
C
1001:{ C1,C2,C3 }
1002:{ C1,C3 }
1003:{ C1 }
1004:{ C2 }
πCno(C) :{ C1,C2,C3 }
Sno
1001
SC ÷ C
查询选修了全部课程的同学学号
『例』


### 幻灯片 42

本章小结
关系运算三要素：运算对象，运算符，运算结果
运算对象：关系
运算结果：关系
谢谢观看！
传统的集合运算 ∪ ∩ － ×
专门的关系运算 σπ    ÷
关系操作

---

## 2.3.2第二章 关系数据库.pptx


### 幻灯片 1

数据库原理


### 幻灯片 2

第二章    关系数据库

	2.1 关系数据模型
	2.2 关系的完整性
	2.3 关系代数


### 幻灯片 3

2.3 关系代数
2.3.3 关系代数运算的应用实例
在关系代数运算中，把几个基本操作经过有限次复合的式子称为关系代数表达式。这个表达式的运算结果依然是一个关系。可以用关系代数表达式表示各种数据查询操作。
查询语句的关系代数表达式的一般形式：


### 幻灯片 4

2.3 关系代数
2.3.3 关系代数运算的应用实例
用关系代数表达式写查询语句的方法：
确定查询所涉及的关系。
执行笛卡尔积或自然联接操作得到一张大的表。
根据查询条件对大表格执行水平分割（选择操作）或垂直分割（投影操作）。
注：
  （1）当查询涉及“否定”时，要用差操作；
  （2）当查询涉及“全部值”时，要用除法操作。


### 幻灯片 5

2.3 关系代数
2.3.3 关系代数运算的应用实例
电力抢修工程数据库中有三个关系：
抢修工程计划表 Salvaging（prj_num,prj_name,start_date,end_date,Prj_status）
    各属性列含义分别是：工程项目编号、工程项目名称、开始日期、结束日期、是否按期完成。 
配电物资库存记录表 Stock（mat_num,mat_name,speci,warehouse,amount,unit,total）
    各属性列含义分别是：物资编号、物资名称、规格、仓库名称、库存数量、单价、总金额。 
配电抢修物资领料出库表 Out_stock
  (prj_num,mat_num,amount,get_date,department)
     各属性列含义分别为：工程项目编号、物资编号、领取数量、领料日期、领料部门。


### 幻灯片 6

2.3 关系代数
2.3.3 关系代数运算的应用实例
关系Salvaging 的一个实例：

**表格内容：**

Prj_num | Prj_name | Start_date | End_date | Prj_status
20100015 | 220KV清经线接地箱及接地线被盗抢修 | 2010-10-12 | 2010-10-13 | 1
20100016 | 沙河站2#公变出线电缆老化烧毁抢修 | 2010-11-05 | 2010-11-05 | 1
20110001 | 西丽站电缆短路烧毁抢修工程 | 2011-01-03 | 2011-01-03 | 1
20110002 | 西丽站电缆接地抢修 | 2011-01-03 | 2011-01-05 | 1
20110003 | 观澜站光缆抢修 | 2011-02-10 | 2011-02-11 | 1
20110004 | 小径墩低压线被盗抢修 | 2011-02-15 | 2011-02-15 | 1
20110005 | 明珠立交电缆沟盖板破损抢修 | 2011-03-02 | 2011-03-05 | 0
20110010 | 朝阳围公变低压线被盗抢修 | 2011-03-08 | 2011-03-10 | 0


### 幻灯片 7

2.3 关系代数
2.3.3 关系代数运算的应用实例
配电物资库存记录表 Stock的一个实例：

**表格内容：**

mat_num | mat_name | speci | warehouse | amount | unit | total
m001 | 护套绝缘电线 | BVV-120 | 供电局1#仓库 | 220 | 89.80 | 19756.00
m002 | 架空绝缘导线 | 10KV-150 | 供电局1#仓库 | 30 | 17.00 | 510.00
m003 | 护套绝缘电线 | BVV-35 | 供电局2#仓库 | 80 | 22.80 | 1824.00
m004 | 护套绝缘电线 | BVV-50 | 供电局2#仓库 | 283 | 32.00 | 9056.00
m005 | 护套绝缘电线 | BVV-70 | 供电局2#仓库 | 130 | 40.00 | 5200.00
m006 | 护套绝缘电线 | BVV-150 | 供电局3#仓库 | 46 | NULL | NULL
m007 | 架空绝缘导线 | 10KV-120 | 供电局3#仓库 | 85 | 14.08 | 1196.80
m009 | 护套绝缘电线 | BVV-16 | 供电局3#仓库 | 90 | NULL | NULL
m011 | 护套绝缘电线 | BVV-95 | 供电局3#仓库 | 164 | NULL | NULL
m012 | 交联聚乙烯绝缘电缆 | YJV22—15KV | 供电局4#仓库 | 45 | 719.80 | 32391.00
m013 | 户外真空断路器 | ZW12-12 | 供电局4#仓库 | 1 | 13600.00 | 13600.00


### 幻灯片 8

2.3 关系代数
2.3.3 关系代数运算的应用实例
配电抢修物资领料出库表 Out_stock的一个实例：

**表格内容：**

prj_num | mat_num | amount | get_date | department
20100015 | m001 | 2 | 2010-10-12 | 工程1部
20100015 | m002 | 1 | 2010-10-12 | 工程1部
20100016 | m001 | 3 | 2010-11-05 | 工程1部
20100016 | m003 | 10 | 2010-11-05 | 工程1部
20110001 | m001 | 2 | 2011-01-03 | 工程2部
20110002 | m001 | 1 | 2011-01-03 | 工程2部
20110002 | m013 | 1 | 2011-01-03 | 工程2部
20110003 | m001 | 5 | 2011-02-11 | 工程3部
20110003 | m012 | 1 | 2011-02-11 | 工程3部
20110004 | m001 | 3 | 2011-02-15 | 工程3部
20110004 | m004 | 20 | 2011-02-15 | 工程3部
20110005 | m001 | 2 | 2011-03-02 | 工程2部
20110005 | m003 | 10 | 2011-03-02 | 工程2部
20110005 | m006 | 3 | 2011-03-02 | 工程2部
20110010 | m001 | 5 | 2011-03-09 | 工程1部


### 幻灯片 9

2.3 关系代数
2.3.3 关系代数运算的应用实例
【例2.7】对于电力抢修工程数据库，用关系代数表达式表达以下每个查询语句。
1.检索所有规格的”护套绝缘电线”的物资编号、库存数量及库存地点。
  πmat_num,warehouse,amount（σmat_name=’ 护套绝缘电线’（Stock））
查询结果：


### 幻灯片 10

2.3 关系代数
2.3.3 关系代数运算的应用实例
2.检索规格为BVV-120的护套绝缘电线的物资编号、库存数量及库存地点。
  
πmat_num,warehouse,amount（σmat_name=’ 护套绝缘电线’ ∧speci=’BVV-120’（Stock））
查询结果：

**表格内容：**

Mat_num | Warehouse | amount
M001 | 供电局1#仓库 | 220


### 幻灯片 11

2.3 关系代数
2.3.3 关系代数运算的应用实例
3.检索项目号为“20100015”抢修项目所使用的物资名称。
 πmat_name（σprj_num=’20100015’（Stock    Out_stock））
或者：   
  πmat_name（Stock   σprj_num=’20100015’（Out_stock））

**表格内容：**

Mat_name
护套绝缘电线
架空绝缘导线
查询结果：


### 幻灯片 12

2.3 关系代数
2.3.3 关系代数运算的应用实例
4.检索使用了物资名称为“护套绝缘电线”的的所有抢修项目编号、名称、物资编号、规格。
Πprj_num,prj_name，mat_num,speci（σmat_name=’护套绝缘电线’（Stock   Out_stock   Salvaging））
或：
πprj_num,prj_name，mat_num,speci（σmat_name=’护套绝缘电线’’（Stock）   Out_stock     Salvaging）
查询结果：


### 幻灯片 13

2.3 关系代数
2.3.3 关系代数运算的应用实例
5.检索不用护套绝缘电线的的所有抢修项目编号

πprj_num（Salvaging）-πprj_num（σmat_name=’ 护套绝缘电线’（Stock   Out_stock））

查询结果为空集，因为所有的抢修工程都使用了护套绝缘电线。


### 幻灯片 14

2.3 关系代数
2.3.3 关系代数运算的应用实例
6.检索使用了物资编号为m001或m002的抢修工程的工程号。
πprj_num（σmat_num=’m001’∨mat_num=’m002’（Out_stock））
查询结果：


### 幻灯片 15

2.3 关系代数
2.3.3 关系代数运算的应用实例
7. 检索同时使用了物资编号为m001和m002的抢修工程的工程号。
π1（σ1=6∧2=‘m001’∧7=‘m002’（ Out_stock×Out_stock））
 
这里（Out_stock×Out_stock）表示关系Out_stock自身相乘的笛卡儿积操作。
查询结果：

**表格内容：**

Prj_num
20100015
Πprj_num, mat_num(out_stock)
÷
πmat_num（σmat_num=’m001’∨mat_num=’m002’（stock））


### 幻灯片 16

2.3 关系代数
2.3.3 关系代数运算的应用实例
8.检索被所有的抢修工程都使用了的物资编号及物资名称、规格。
 编写这个查询语句的关系代数表达式过程如下：
①抢修工程使用的物资编号情况：
  πprj_num,mat_num（Out_stock）
②全部抢修工程项目编号：
  πprj_num（salaving）
③被所有的抢修工程都使用了的物资编号：
  πprj_num,mat_num（Out_stock）÷πprj_num（salaving）
④从mat_num求物资名称、规格，可以用自然连接和投影操作组合而成：
πmat_num,mat_name,spci（Stock    (πprj_num,mat_num（Out_stock）÷πprj_num（salaving））


### 幻灯片 17

2.3 关系代数
2.3.3 关系代数运算的应用实例
9. 检索所用物资包含抢修工程20100016所用物资的抢修工程号。
①抢修工程使用的物资编号情况:
   πprj_num,mat_num（Out_stock）
②抢修工程20100016所用物资编号:
πmat_num（σprj_num=’20100016’（ Out_stock））
③所用物资包含抢修工程20100016所用物资的抢修工程号：
  πprj_num,mat_num（Out_stock）÷πmat_num（σprj_num=’20100016’（ Out_stock））
查询结果：

---

