# 【考场精简】第8章 数据库设计

## 一、数据库设计概述

**数据库设计定义**：为给定应用环境构造最优数据库模式，建立数据库及应用系统，有效存储数据，满足用户的信息要求和处理要求。

**设计目标**：为用户和各种应用系统提供信息基础设施和高效率运行环境。

**数据库建设基本规律**：三分技术，七分管理，十二分基础数据。

### 设计方法

**规范设计法**：基本思想是过程迭代和逐步求精。典型方法包括基于E-R模型的设计方法、3NF第三范式设计方法。

**计算机辅助设计法**：使用工具如Rational Rose、PowerDesigner、Oracle Designer等。

### 数据库设计六个阶段

**1. 需求分析阶段**：了解并收集用户需求，形成需求分析说明书。

**2. 概念设计阶段**：对用户需求进行综合、归纳与抽象，形成独立于DBMS的概念数据模型，通常使用E-R图表示。

**3. 逻辑设计阶段**：将概念数据模型转化为某一DBMS所支持的数据模型，形成数据库逻辑模式，建立必要的视图形成外模式。

**4. 物理设计阶段**：为逻辑数据模型选择最适合应用环境的物理结构，形成数据库内模式。

**5. 数据库实施阶段**：在计算机系统中建立数据库结构、载入数据、测试程序、试运行。

**6. 数据库运行与维护阶段**：数据库系统正式投入运行，由DBA承担日常维护工作。

### 设计特点

**结构设计与行为设计相结合**：结构设计是静态稳定的，包括概念设计、逻辑设计和物理设计。行为设计是动态的，包括应用程序设计、事务处理设计等。

---

## 二、需求分析

**需求分析任务**：通过详细调查现实世界要处理的对象，充分了解原系统工作概况，明确用户各种需求，确定新系统功能。必须充分考虑今后可能的扩充和改变。

### 需求分析步骤

**第一步：调查分析用户活动**，调查组织机构情况以及各部门业务活动情况。

**第二步：收集和分析需求数据，确定系统边界**，明确用户的信息需求、处理需求、安全性和完整性需求等。

**第三步：编写系统需求分析报告**，包括数据流图、功能模块图、数据字典等。

### 需求分析重点

**信息要求**：用户需要从数据库中获得的信息内容与性质，由此导出数据要求，即需要在数据库中存储哪些数据。

**处理要求**：对处理功能的要求、对处理响应时间的要求、对处理方式的要求如批处理或联机处理。

**安全性与完整性要求**：确保数据的安全性和一致性。

### 数据字典

**数据字典定义**：各类数据描述的集合，用来说明系统中数据的静态组成结构，是数据库系统中各类数据属性的清单。

**数据字典内容包括五部分**：

**1. 数据项**：不可再分的数据单位。描述包括数据项名、含义说明、别名、数据类型、长度、取值范围、取值含义、与其他数据项的逻辑关系。

例：物资编号，含义为库存物资唯一标识，类型为字符型，长度为4，取值范围m001到m999。

**2. 数据结构**：反映数据之间的组合关系，由若干数据项或数据结构组成。描述包括数据结构名、含义说明、组成。

例：抢修物资数据结构，组成包括物资编号、物资名称、物资规格、保存的仓库、库存数量、单价。

**3. 数据流**：数据结构在系统内传输的路径。描述包括数据流名、说明、数据流来源、数据流去向、组成、平均流量、高峰期流量。

**4. 数据存储**：数据结构停留或保存的地方。描述包括数据存储名、说明、编号、输入输出的数据流、组成、数据量、存取频度、存取方式。

**5. 处理过程**：描述包括处理过程名、说明、输入输出数据流、处理逻辑。

---

## 三、概念设计

**概念设计任务**：将需求分析得到的用户需求抽象为信息结构即概念模型的过程。

**概念结构特点**：能真实充分反映现实世界、易于理解、易于更改、易于向各种数据模型转换。

**描述工具**：实体联系模型，即E-R模型。

### E-R模型基本概念

**实体**：现实世界中客观存在并可相互区别的事物。

**属性**：实体所具有的某一特性。

**码**：唯一表示实体的属性集。

**域**：属性的取值范围。

**实体型**：用实体名及其属性名集合来抽象和刻画同类实体。例：员工（员工编号、姓名、部门、性别、年龄、职称）。

**实体集**：具有相同特征的实体集合。

**联系**：实体之间的关系，分为三类。

### 实体间联系类型

**1对1联系1:1**：对于实体集A中的每一个实体，实体集B中至多有一个实体与之联系，反之亦然。

例：部门与负责人之间的关系，一个部门只有一个负责人，一个负责人只负责一个部门。

**1对多联系1:n**：对于实体集A中的每一个实体，实体集B中有n个实体与之联系，反之对于实体集B中的每一个实体，实体集A中至多只有一个实体与之联系。

例：部门与员工之间的关系，一个部门有多个员工，一个员工只属于一个部门。

**多对多联系m:n**：对于实体集A中的每一个实体，实体集B中有n个实体与之联系，反之对于实体集B中的每一个实体，实体集A中也有m个实体与之联系。

例：学生与课程之间的关系，一个学生可以选修多门课程，一门课程可被多个学生选修。

**弱实体集**：属性不足以形成主码，需要依赖其他实体集中的部分属性的实体集。例：工作履历实体集依赖于员工实体集而存在。

### E-R图表示方法

**矩形**：表示实体，矩形内写实体名。

**椭圆形**：表示属性，键值属性加下划线。

**菱形**：表示联系。

**连线**：连接实体型与联系类型，并注明联系种类1:1、1:n、m:n。

**虚边矩形和虚边菱形**：分别表示弱实体和弱实体之间的联系。

### E-R图设计步骤

**第一步**：确定实体类型及相应的实体名。

**第二步**：确定联系类型，包括各实体类型之间的联系种类及相应的联系名。

**第三步**：连接实体类型和联系类型，组合成E-R图。

**第四步**：确定实体类型和联系类型的属性。

**第五步**：确定实体类型的码。

### 概念结构设计方法

**常用策略**：自顶向下地进行需求分析，自底向上地设计概念结构。

**自底向上设计步骤**：

**第1步：抽象数据并设计局部视图**。选择中层数据流图作为设计分E-R图的依据，将各局部应用涉及的数据从数据字典中抽取出来，标定局部应用中的实体、实体属性、实体的码，确定实体之间的联系及其类型。

**第2步：集成局部视图，得到全局概念结构**。

### 局部E-R图集成方法

**集成方式**：多元集成法适用于局部视图比较简单时；二元集成法首先集成两个关键的局部视图，然后每次将一个新的局部视图集成进来。

**集成步骤**：

**第一步：合并**，解决各局部E-R图之间的冲突，将各分E-R图合并起来生成初步E-R图。

**第二步：优化**，消除不必要的冗余，生成全局E-R图。

### 合并时需解决的三种冲突

**属性冲突**：

**属性域冲突**：属性值的类型、取值范围或取值集合不同。

**属性取值单位冲突**：同一属性在不同局部应用中使用不同单位。

例：课程属性中，选课管理用学分属性，教师开课管理用学时属性，而学时和学分是互通的，应统一用一种。

**命名冲突**：

**同名异义**：不同意义的对象在不同局部应用中具有相同名字。

**异名同义**：同一意义的对象在不同局部应用中具有不同名字。

例：学籍管理和选课管理都用学院实体，而教师开课管理中用部门实体，其实学院和部门表示同一种实体，应统一为学院。

**结构冲突**：

**同一对象在不同应用中具有不同抽象**。

例：专业在学籍管理中被当作实体，而在选课管理中则被当作属性。

解决方法准则：属性不能再具有需要描述的性质；属性不能与其他实体具有联系；为了简化E-R图的处理，现实世界中的事物凡能够作为属性对待的应尽量作为属性。

**同一实体在不同分E-R图中所包含的属性不完全相同或排列次序不同**。

解决方法：使该实体的属性取各分E-R图中属性的并集，再适当调整属性次序。

**实体之间的联系在不同局部视图中呈现不同类型**。

解决方法：根据应用语义对实体联系的类型进行综合或调整。

### 优化：消除冗余

**冗余的数据**：可由基本数据导出的数据。

**冗余的联系**：可由其他联系导出的联系。

冗余容易破坏数据库完整性，给数据库维护增加困难。

**消除冗余方法**：以数据字典和数据流图为依据，根据数据字典中关于数据项之间逻辑关系的说明来消除冗余。

例：选课联系中的绩点属性可以由成绩推算出来，属于冗余数据可以去掉。学院实体与课程实体之间的开设联系，可以由学院与教师实体之间的属于联系、教师与课程实体之间的讲授联系推导出来，属于冗余联系。

---

## 四、逻辑设计

**逻辑设计任务**：将概念结构设计好的E-R图转化为相应的数据模型。

### 逻辑设计步骤

**第一步**：将概念结构转化为一般的关系模型。

**第二步**：将转化来的关系模型向特定DBMS支持下的数据模型转换。

**第三步**：对数据模型进行优化。

### E-R图转化为关系模型的转换原则

**原则1：一个实体型转换为一个关系模式**。

关系的属性为实体型的属性，关系的码为实体型的码。

例：学院（学院编号，学院名）、专业（专业号，专业名）、班级（班级号，班级名）、学生（学号，姓名，性别，出生日期）、课程（课程号，课程名）、教师（工号，姓名，性别，职称）。

**原则2：一个1:1联系可转换为一个独立的关系模式，也可以与任意一端对应的关系模式合并**。

转换为独立关系模式时：关系的属性为与该联系相连的各实体的码以及联系本身的属性；关系的码为每个实体的码均是该关系的候选码。

与某一端合并时：关系的属性为在该关系模式中加入对应关系的码和联系本身的属性；关系的码不变。

例：负责联系为1:1联系，有三种转换方法：转换为独立关系模式负责（学院编号，工号）；或与系关系合并系（学院编号，系名，工号）；或与负责人关系合并负责人（工号，姓名，性别，学院编号）。

注意：从理论上讲1:1联系可以与任意一端对应的关系模式合并，但在一些情况下与不同的关系模式合并效率会大不一样，应以尽量减少连接操作为目标。

**原则3：一个1:n联系可转换为一个独立的关系模式，也可以与n端对应的关系模式合并**。

转换为独立关系模式时：关系的属性为与该联系相连的各实体的码以及联系本身的属性；关系的码为n端实体的码。

与n端合并时：关系的属性为在n端关系模式中加入1端关系的码和联系本身的属性；关系的码不变。

例：开设联系为1:n联系，有两种转换方法：转换为独立关系模式开设（学院编号，专业号）；或与专业关系合并专业（专业号，专业名，学院编号）。

**原则4：一个m:n联系可转换为一个关系模式**。

关系的属性为与该联系相连的各实体的码以及联系本身的属性；关系的码为各实体码的组合。

例：选修联系是m:n联系，转换为选修（学号，课程号，成绩），其中学号与课程号为关系的组合码。

**原则5：三个或三个以上实体间的一个多元联系可转换为一个关系模式**。

关系的属性为与该多元联系相连的各实体的码以及联系本身的属性；关系的码为各实体码的组合。

例：供应联系转换为供应（供应商号，项目号，零件号，数量）。

**原则6：具有相同码的关系模式可合并**。

目的是减少系统中的关系个数。合并方法是将其中一个关系模式的全部属性加入到另一个关系模式中，然后去掉其中的同义属性，并适当调整属性次序。

例：开设（系号，专业号）和专业（专业号，专业名）可合并为专业（专业号，专业名，系号）。

### 关系模式优化

**为什么要优化**：数据库逻辑设计的结果不是唯一的，得到初步数据模型后还应适当修改调整数据模型的结构，以进一步提高数据库应用系统的性能。优化通常以规范化理论为指导。

**优化步骤**：

**第1步**：确定数据依赖，按需求分析阶段所得到的语义，分别写出每个关系模式内部各属性之间的数据依赖以及不同关系模式属性之间的数据依赖。

**第2步**：对于各个关系模式之间的数据依赖进行极小化处理，消除冗余的联系。

**第3步**：按照数据依赖的理论对关系模式逐一进行分析，考查是否存在部分函数依赖、传递函数依赖、多值依赖等，确定各关系模式分别属于第几范式。

例：在关系模式工资（工号，姓名，基本工资，岗位补贴，应发工资，五险一金，实发工资）中存在函数依赖：工号→姓名基本工资岗位工资；基本工资岗位工资→应发工资；应发工资→五险一金；应发工资五险一金→实发工资。显然有工号→应发工资五险一金实发工资，因此该关系模式中存在传递函数依赖，是2NF关系。

**注意**：并不是规范化程度越高的关系就越优。当一个应用的查询中经常涉及到两个或多个关系模式的属性时，系统必须经常地进行联接运算，而联接运算的代价相当高。对于一个具体应用，规范化进行到什么程度需要权衡响应时间和潜在问题两者的利弊才能决定。

虽然应发工资、五险一金、实发工资可以由其他属性推算出来，但如果应用中需要经常查询职工的这些工资项，为提高效率仍然可保留该冗余数据，对关系模式不再做进一步分解。一种更好的方法是把冗余数据定义在视图中。

**第4步**：按照需求分析阶段得到的各种应用对数据处理的要求，分析对于这样的应用环境这些模式是否合适，确定是否要对它们进行合并或分解。

**第5步**：对关系模式进行必要的分解，以提高数据操作的效率和存储空间的利用率。

### 关系模式的分解

**水平分解**：把基本关系的元组分为若干子集合，定义每个子集合为一个子关系，以提高系统效率。

适用范围：

满足80/20原则的应用，即一个大关系中经常被使用的数据只是关系的一部分约20%，把经常使用的数据分解出来形成子关系，可以减少查询的数据量。

例：某网站注册用户关系用户（用户ID，用户名等），只有少部分是活跃用户，其他用户很少登录。水平分割为活跃用户和非活跃用户两个关系。

并发事务经常存取不相交的数据。

例：某大学学生信息表学生（学号，姓名，出生年月等），多数查询一次仅涉及其中一类学生。水平分割为本科生、硕士生、博士生三个关系。

**垂直分解**：把关系模式R的属性分解为若干子集合，形成若干子关系模式。

适用范围：取决于分解后R上的所有事务的总效率是否得到了提高。

原则：垂直分解必须保持无损连接性和保持函数依赖。

优点：减少数据传递量，提高查询速度。

例：学生情况的关系模式学生（学号，姓名，性别，出生年月，专业班级，家庭住址，联系方式，家庭联系人），经常查询前五项，较少使用后三项。垂直模式分解为Student1（学号，姓名，性别，出生年月，专业班级）和Student2（学号，家庭住址，联系方式，家庭联系人）。

一个表中的字段同时存在经常查询和非经常查询的属性，均可采用垂直分割的方法。

### 设计用户子模式

**定义外模式原则**：从系统的时间效率、空间效率、易维护等角度出发定义数据库模式；定义用户外模式时应更注重考虑用户的习惯与方便。

**包括三个方面**：

**使用更符合用户习惯的别名**。

例：负责学籍管理的用户习惯于称教师模式的工号为教师编号，因此可以定义视图，在视图中职工号重定义为教师编号。

**针对不同级别的用户定义不同的外模式以满足系统对安全性的要求**。

例：关系模式学生（学号、姓名、性别、出生日期、班级、入学年份、家庭住址），教务管理系统只能查询学生的学号、姓名、性别、班级、入学年份，定义外模式视图学生_教务系统（学号、姓名、性别、班级、入学年份）。这样可以防止用户非法访问本来不允许他们查询的数据，保证了系统的安全性。

**简化用户对系统的使用**。

如果某些局部应用中经常要使用某些很复杂的查询，为了方便用户可以将这些复杂查询定义为视图。

---

## 五、物理设计

**物理设计定义**：为一个给定的逻辑数据模型选取一个最适合应用要求的物理结构的过程。

**数据库的物理结构**：数据库在物理设备上的存储结构与存取方法，依赖于给定的计算机系统。

**设计准备工作**：

充分了解应用环境，详细分析要运行的事务，以获得选择数据库物理设计所需参数，特别是应用的处理频率和响应时间要求。

充分了解所用RDBMS的内部特征，特别是系统提供的存取方法和存储结构。有哪些存储结构如行存储、列存储、聚簇存储，如何选择。有哪些索引如B加树索引、HASH索引等，如何建立索引。

熟悉外存设备的特性，如分块原则、块因子大小的规定、设备的I/O特性等。

**注意**：不同的DBMS产品物理环境、存取方法和存储结构有很大差别，能供设计人员使用的设计变量、参数范围很不相同，没有通用的物理设计方法，只能给出一般的设计内容和原则。

### 物理设计步骤

**第一步：确定数据库的物理结构，包括存取方法和存储结构**。

**确定数据的存储结构**：考虑因素包括存取时间、存储空间利用率和维护代价等。

**设计合适的存取路径**：主要指确定如何建立索引。

**确定数据的存放位置**：根据应用情况将易变部分与稳定部分、存取频率较高部分与存取频率较低部分分开存放，以提高系统性能。

**确定系统配置**：DBMS产品一般都提供了一些系统配置变量和存储分配参数。

**第二步：对物理结构进行评价**。

评价内容：对数据库物理设计过程中产生的多种方案对其时间效率、空间效率、维护代价和各种用户需求进行细致的评价，从中选择一个较优的方案作为数据库的物理结构。

评价方法：定量估算各种方案的存储空间、存取时间以及维护代价；对估算结果进行权衡比较选择出一个较优的合理的物理结构；如果该结构不符合用户需求则需要修改设计。

**注意**：数据库的物理设计不是一劳永逸的，要根据应用的变化及时收集设计信息，调整数据库的物理结构。

---

## 六、数据库实施、运行与维护

### 数据库实施的工作内容

**第一步：用DDL定义数据库结构**。

例：CREATE TABLE stocks（mat_no char(8) primary key，……check……）；CREATE VIEW view1（……）；CREATE INDEX ……。

**第二步：组织数据入库**，即数据装载ETL。

数据装载方法：人工方法适用于小型系统；计算机辅助数据入库适用于中大型系统。

**第三步：编制与调试应用程序**。

数据库应用程序的设计应与数据库设计同时进行。在数据库实施阶段当数据库结构建立好后就可以开始编制与调试数据库的应用程序。调试应用程序时由于数据入库尚未完成，可先使用模拟数据。

**第四步：数据库试运行**。

也称为联合调试，主要工作包括：

**功能测试**：实际运行应用程序执行对数据库的各种操作，测试应用程序的各种功能。

**性能测试**：测试系统的性能指标分析是否符合设计目标。如果结果不符合设计目标则需要返回物理设计阶段调整物理结构修改参数，有时甚至需要返回逻辑设计阶段调整逻辑结构。

### 数据库实施过程中注意事项

**组织数据分批分期入库**，先输入小批量数据做调试使用，待试运行基本合格后再大批量输入数据。

**首先调试运行DBMS的恢复功能**，做好数据库的转储和恢复工作。在数据库试运行阶段系统还不稳定，硬软件故障随时都可能发生，系统的操作人员对新系统还不熟悉，误操作也不可避免。

**整理文档**。在应用程序编制调试及试运行时应该随时将发现的问题的解决方案记录下来整理成文档，以备运行维护和改进时参考。试运行成功后还应编写测试报告、应用系统的技术说明书和使用说明书，在正式使用时一并交给用户。完整的文档是应用系统的重要组成部分。

### 数据库运行与维护

在数据库运行阶段对数据库经常性的维护工作主要是由DBA完成的，包括：

**1. 数据库的转储和恢复**。

转储和恢复是系统正式运行后最重要的维护工作之一。DBA要针对不同的应用要求制定不同的转储计划，定期对数据库和日志文件进行备份。一旦发生介质故障即利用数据库备份及日志文件备份，尽快将数据库恢复到某种一致性状态。

**2. 数据库的安全性、完整性控制**。

DBA必须根据用户的实际需要授予不同的操作权限。在数据库运行过程中由于应用环境的变化，对安全性的要求也会发生变化，DBA需要根据实际情况修改原有的安全性控制。由于应用环境的变化数据库的完整性约束条件也会变化，也需要DBA不断修正以满足用户要求。

**3. 数据库性能的监督、分析和改进**。

在数据库运行过程中DBA必须监督系统运行，对监测数据进行分析找出改进系统性能的方法。利用监测工具获取系统运行过程中一系列性能参数的值，通过仔细分析这些数据判断当前系统是否处于最佳运行状态。如果不是则需要通过调整某些参数来进一步改进数据库性能。

**4. 数据库的重组织和重构造**。

**数据库的重组织**：

重组织形式包括全部重组织和部分重组织，只对频繁增删的表进行重组织。

重组织工作：按原设计要求重新安排存储位置、回收垃圾、减少指针链等，以提高系统性能。

重组织实质：不会修改原设计的逻辑和物理结构。

**数据库的重构造**：

重构造工作：根据新环境调整数据库的模式和内模式，比如增加新的数据项、改变数据项的类型、改变数据库的容量、增加或删除索引、修改完整性约束条件。

重构造实质：部分修改数据库的模式和内模式。

重构造局限：部分重构造。若变化太大无法通过重构数据库来满足新的需求，或重构数据库的代价太大，则表明现有数据库应用系统的生命周期已经结束，应该重新设计新的数据库应用系统了。

---

## 七、典型例题

### 例题1：教务管理系统E-R图转换

**题目**：某教务管理系统有以下语义，请转换为关系模式。

语义描述：一个学院开设多个专业（1:n），一个专业有多个班级（1:n），一个班级有多个学生（1:n），一个学生可选修多门课程（m:n），一门课程可为多个学生选修，一个学院可开设多门课程（1:n），一名教师可讲授多门课程（m:n），一门课程可为多名教师讲授，一个学院有多名教师（1:n），一个学院只有一个负责人（1:1）。

**解答**：

学院（学院编号，学院名）

专业（专业号，专业名，学院编号）——将1:n的开设联系与n端合并

班级（班级号，班级名，专业号）——将1:n的拥有联系与n端合并

学生（学号，姓名，性别，出生日期，班号）——将1:n的包含联系与n端合并

课程（课程号，课程名，学院编号）——将1:n的开设联系与n端合并

教师（工号，姓名，性别，职称，学院编号）——将1:n的属于联系与n端合并

选修（学号，课程号，成绩）——m:n联系转换为独立关系，组合码

讲授（工号，课程号，学时）——m:n联系转换为独立关系，组合码

负责人（工号，姓名，性别，学院编号）——1:1联系与负责人端合并

### 例题2：关系模式优化判断

**题目**：关系模式工资（工号，姓名，基本工资，岗位补贴，应发工资，五险一金，实发工资）中，应发工资等于基本工资加岗位补贴，实发工资等于应发工资减五险一金，五险一金根据应发工资计算。请分析该关系属于第几范式，是否需要分解。

**解答**：

存在函数依赖：工号→姓名基本工资岗位补贴；基本工资岗位补贴→应发工资；应发工资→五险一金；应发工资五险一金→实发工资。

显然有工号→应发工资五险一金实发工资，存在传递函数依赖，该关系模式是2NF。

是否分解需要根据应用需求：如果经常查询这些工资项，为提高效率可保留冗余数据不分解。更好的方法是把冗余数据定义在视图中，基表只保留工号、姓名、基本工资、岗位补贴，应发工资、五险一金、实发工资通过视图计算得到。

### 例题3：水平分解与垂直分解

**题目**：某大学学生表学生（学号，姓名，性别，出生年月，专业班级，家庭住址，联系方式，家庭联系人，入学年份，学生类别），其中学生类别包括本科生、硕士生、博士生。查询统计显示80%的查询只涉及前五个属性，且多数查询一次只针对某一类学生。请给出优化方案。

**解答**：

可以同时采用水平分解和垂直分解：

**水平分解**：按学生类别分为本科生（学号，姓名，性别，出生年月，专业班级，家庭住址，联系方式，家庭联系人，入学年份）、硕士生（学号，姓名，性别，出生年月，专业班级，家庭住址，联系方式，家庭联系人，入学年份）、博士生（学号，姓名，性别，出生年月，专业班级，家庭住址，联系方式，家庭联系人，入学年份）三个关系。

**垂直分解**：将常用属性和非常用属性分开，每类学生分为两个关系。如本科生基本信息（学号，姓名，性别，出生年月，专业班级）和本科生详细信息（学号，家庭住址，联系方式，家庭联系人，入学年份）。

这样既减少了查询时扫描的数据量，又将常用数据与非常用数据分离，大大提高了查询效率。

### 例题4：物理设计中的索引选择

**题目**：某仓库管理系统中，零件表零件（零件号，零件名，规格，单价，库存量），经常执行以下操作：按零件号精确查找零件信息；按零件名模糊查找零件；统计库存量小于100的零件；按单价排序输出零件清单。请设计索引方案。

**解答**：

在零件号上建立**主键索引**（唯一索引）：因为零件号是主键，需要频繁精确查找，建立B加树索引可以快速定位。

在零件名上建立**普通索引**：虽然有模糊查询，但建立索引后至少可以加速前缀匹配的模糊查询。

在库存量上建立**普通索引**：因为经常按库存量范围查询，B加树索引适合范围查询。

在单价上建立**普通索引**：因为需要按单价排序，索引可以避免额外的排序操作。

注意：索引会占用存储空间并降低更新速度，需要根据查询频率和更新频率权衡。如果某个字段更新非常频繁而查询很少，可以不建索引。

---

## 八、重点记忆口诀

**数据库设计六阶段**：需概逻物实运维。

**E-R图转关系原则**：实体变关系码不变，1:1随意合并，1:n合n端，m:n独立建，多元联系码组合。

**三种冲突**：属性冲突看域和单位，命名冲突同名异义异名同义，结构冲突同一对象不同抽象。

**优化不是越高越好**：权衡响应时间和潜在问题，连接代价高时低范式更优。

**水平分解**：80/20原则，按类别分，常用与不常用分。

**垂直分解**：常查与非常查分开，减少数据传递量。

**物理设计关键**：存储结构选择，索引建立，数据存放位置，系统配置。

**DBA运维四大任务**：转储恢复，安全完整性控制，性能监督改进，重组织重构造。

---

## 考场提示

1. **E-R图转关系时注意**：1:n联系优先与n端合并可减少连接操作；m:n联系必须独立建立关系。

2. **判断范式时**：先找候选码，再看是否存在非主属性对码的部分依赖和传递依赖。

3. **优化决策时**：如果经常联合查询多个表不要过度分解；如果只查单表某些字段考虑垂直分解。

4. **物理设计时**：频繁查询的字段建索引，频繁更新的字段慎建索引；范围查询用B加树，精确查询可用HASH。

5. **实施阶段**：先小批量数据调试，先测恢复功能，文档要完整。

---

**本章完**