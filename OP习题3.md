# 操作系统原理 - 模拟试卷三

## 📋 使用说明

**建议使用方法**：
1. 先独立完成模拟试卷（限时）
2. 对照答案批改
3. 仔细阅读解题思路
4. 总结错题和薄弱点

---

## 一、填空题（10分）

1. 操作系统的四大特征是______、______、______和______。

2. 进程的状态转换中，从就绪态到运行态的转换由______引起，从运行态到阻塞态的转换由______引起。

3. 在请求分页系统中，若快表命中率为80%，访问快表时间为10ns，访问内存时间为100ns，则有效访问时间为______ns。

4. 死锁检测使用______来描述系统的资源分配情况。资源剥夺法解除死锁时，需要防止同一进程总被剥夺而产生______现象。

5. 文件的物理结构有连续结构、______结构和______结构。混合索引是______结构的一种改进形式。

---

## 二、设计题（15分）

**题目**：有三个并发执行的线程thread1、thread2和thread3，它们都需要访问三个全局变量x、y、z：
- thread1需要访问x和y
- thread2需要访问y和z  
- thread3需要访问x、y和z

请用信号量和PV操作实现三个线程对共享变量的互斥访问。

**要求**：
1. 定义所需的信号量及初始值
2. 用cobegin/coend表示并发线程
3. 写出各线程的伪代码
4. 确保不会发生死锁

---

## 三、问答题（40分）

### 题目1：进程调度（10分）

某系统有4个进程，它们的到达时间和服务时间如下表所示：

| 进程 | 到达时间 | 服务时间 |
|------|---------|---------|
| P1   | 0       | 8       |
| P2   | 1       | 4       |
| P3   | 2       | 2       |
| P4   | 3       | 1       |

请分别用以下算法计算平均周转时间和平均带权周转时间：
1. 时间片轮转调度（时间片=2）
2. 多级反馈队列调度（第一队列时间片=1，第二队列时间片=2，第三队列FCFS）

要求画出甘特图，列出计算过程。

---

### 题目2：银行家算法（10分）

某系统有4种资源类型A、B、C、D，数量分别为4、2、3、1。在T0时刻，系统中有3个进程P0、P1、P2，它们的资源分配情况如下：

|     | Max资源需求 |     |     |     | Allocation已分配 |     |     |     |
|-----|------------|-----|-----|-----|-----------------|-----|-----|-----|
|     | A          | B   | C   | D   | A               | B   | C   | D   |
| P0  | 3          | 2   | 1   | 1   | 2               | 0   | 0   | 1   |
| P1  | 0          | 2   | 1   | 0   | 0               | 1   | 0   | 0   |
| P2  | 1          | 1   | 3   | 0   | 1               | 1   | 1   | 0   |

请回答：
1. 计算Need矩阵和Available向量
2. 判断T0时刻系统是否处于安全状态？如果是，给出一个安全序列
3. 如果进程P0请求资源(1, 0, 1, 0)，系统是否应该分配？
4. 如果在初始状态下，P1先请求(0, 1, 0, 0)并获得分配，然后P0请求(1, 0, 0, 0)，系统是否应该分配？

---

### 题目3：页面置换算法（10分）

某进程的逻辑地址空间为16页，页面大小为4KB。该进程访问的逻辑地址序列（十六进制）为：
0x1234, 0x5678, 0x2ABC, 0x8DEF, 0x1111, 0x6543, 0x2222, 0xA000, 0x3333, 0x9876

系统分配给该进程3个页框，初始时页框为空。

请：
1. 将逻辑地址序列转换为页号序列
2. 用LRU算法进行页面置换，计算缺页次数和缺页率
3. 用Clock算法进行页面置换（初始时钟指针指向页框0），计算缺页次数和缺页率

---

### 题目4：文件系统（10分）

某文件系统的磁盘容量为1GB，磁盘块大小为4KB，采用位示图（bitmap）管理空闲磁盘块。

请回答：
1. 位示图需要占用多少磁盘块？
2. 如何从位示图中找到第一个空闲磁盘块？
3. 如何分配连续的10个磁盘块？
4. 如何回收磁盘块号为1000的磁盘块？

---

## 四、选择题（15分，每题3分）

### 题目1
在下列存储管理方案中，不适合多道程序系统的是（ ）

A. 可重定位分区  
B. 分页存储管理  
C. 固定分区  
D. 单一连续分区

---

### 题目2
某进程在执行过程中需要等待从磁盘上读入数据，此时进程的状态将（ ）

A. 从就绪态变为运行态  
B. 从运行态变为就绪态  
C. 从运行态变为阻塞态  
D. 保持运行态不变

---

### 题目3
在分页系统中，页表的作用是（ ）

A. 实现从页号到物理块号的转换  
B. 实现从物理块号到页号的转换  
C. 实现从逻辑地址到物理地址的转换  
D. 既包括A又包括C

---

### 题目4
下列关于SPOOLing系统的叙述中，错误的是（ ）

A. SPOOLing系统将独占设备改造为共享设备  
B. SPOOLing系统需要大容量的磁盘支持  
C. SPOOLing系统可以提高设备利用率  
D. SPOOLing系统只能用于输出设备

---

### 题目5
在UNIX文件系统中，文件系统的根目录的Inode号通常是（ ）

A. 0  
B. 1  
C. 2  
D. 由系统随机分配

---

## 五、简答题（20分，每题5分）

### 题目1
什么是工作集？工作集算法如何防止抖动？

---

### 题目2
比较FCFS、SSTF和SCAN磁盘调度算法的优缺点和适用场景。

---

### 题目3
请说明文件的逻辑结构和物理结构的区别，以及它们之间的关系。

---

### 题目4
请从操作系统原理的角度，说明现代数据库系统（如MySQL）是如何利用操作系统的缓冲技术和磁盘调度技术来提高性能的。

---

## 📝 答题提示

**填空题答案提示**：
1. 并发性、共享性、虚拟性、异步性
2. 调度程序选中（或进程调度）；等待I/O或事件（或请求I/O）
3. 128
4. 资源分配图；饥饿
5. 链接；索引；索引

**填空题3计算过程**：
```
有效访问时间 = 命中率 × (访问快表 + 访问内存) + (1-命中率) × (访问快表 + 2×访问内存)
            = 0.8 × (10 + 100) + 0.2 × (10 + 2×100)
            = 0.8 × 110 + 0.2 × 210
            = 88 + 42
            = 130ns

注意：未命中时需要先访问快表（失败），再访问页表（1次内存），再访问数据（1次内存）
```

**设计题提示**：
- 可以为每个共享变量设置信号量：mutex_x, mutex_y, mutex_z
- 注意避免死锁：统一按照x→y→z的顺序申请资源
- 或者使用AND型信号量一次性申请所有需要的资源

**问答题提示**：
- 题目1：时间片轮转注意时间片用完要重新排队；多级反馈队列注意队列降级规则
- 题目2：4种资源类型，注意计算不要遗漏；多次资源请求要分步判断
- 题目3：先将十六进制地址转为十进制，再除以4096得到页号
- 题目4：位示图大小 = 总块数 / 8（bit转byte）；用位操作查找和修改

**选择题答案提示**：
1. D  2. C  3. D  4. D  5. C

**简答题答案要点**：
1. 工作集定义、工作集窗口、防止抖动的机制
2. FCFS（简单但可能有长等待）、SSTF（性能好但可能饥饿）、SCAN（公平且性能好）
3. 逻辑结构面向用户，物理结构面向存储；通过文件系统映射
4. 数据库缓冲池（内存管理）、预读机制（局部性原理）、磁盘调度优化

---

**祝您考试顺利！🎉**



